<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Audio Scope</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="/static/styles.css"/>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="title">Audio Scope</div>
      <div class="subtitle">Serial TLV → Live waveform (10s) + CSV auto record</div>
    </div>

    <div class="status-wrap">
      <div class="pill" id="recPill">REC • OFF</div>
      <div class="pill" id="connPill">Disconnected</div>
    </div>
  </header>

  <main class="layout">
    <aside class="panel">
      <div class="panel-title">Connection</div>

      <label>Port</label>
      <select id="portSelect"></select>
      <div class="meta" id="portMeta">—</div>

      <div class="grid2">
        <div>
          <label>Baudrate</label>
          <input id="baudInput" type="number" value="921600" min="1200" step="1"/>
        </div>
        <div>
          <label>Sample rate (Hz)</label>
          <input id="srInput" type="number" value="16000" min="1000" step="1000"/>
        </div>
      </div>

      <div class="actions">
        <button id="refreshBtn">Refresh</button>
        <button class="primary" id="connectBtn">Connect</button>
        <button id="disconnectBtn" disabled>Disconnect</button>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="k">Last device ts</div>
          <div class="v" id="tsVal">—</div>
        </div>
        <div class="stat">
          <div class="k">Plot window</div>
          <div class="v">10 s</div>
        </div>
        <div class="stat">
          <div class="k">Plot refresh</div>
          <div class="v">1 Hz</div>
        </div>
      </div>

      <div class="hint">
        Recording starts automatically on <b>Connect</b> and stops on <b>Disconnect</b>.
      </div>
    </aside>

    <section class="main">
      <div class="card">
        <div class="card-head">
          <div>
            <div class="card-title">Live Waveform</div>
            <div class="card-sub">Last 10 seconds (scrolling)</div>
          </div>
          <div class="mini">
            <span class="dot" id="dot"></span>
            <span id="miniText">No data</span>
          </div>
        </div>

        <div id="chart" class="chart"></div>
      </div>

      <div class="card logs">
        <div class="card-head">
          <div>
            <div class="card-title">Logs</div>
            <div class="card-sub">Connection + streaming events</div>
          </div>
          <button id="clearLogsBtn" class="ghost">Clear</button>
        </div>
        <div id="logBox" class="logbox"></div>
      </div>
    </section>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
